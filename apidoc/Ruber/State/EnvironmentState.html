<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Ruber::State::EnvironmentState
  
    &mdash; Ruber API
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (E)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../Ruber.html" title="Ruber (module)">Ruber</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../State.html" title="Ruber::State (module)">State</a></span></span>
     &raquo; 
    <span class="title">EnvironmentState</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Ruber::State::EnvironmentState
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="Plugin.html" title="Ruber::State::Plugin (class)">Plugin</a></span>, <span class='object_link'><a href="ProjectExtension.html" title="Ruber::State::ProjectExtension (class)">ProjectExtension</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">plugins/state/state.rb</dd>
  
</dl>
<div class="clear"></div>










  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <!-- Provides the  slot annotation -->
<li class="public ">
  <span class="summary_signature">
    
      <a href="#restore_environment-instance_method" title="#restore_environment (instance method)">- (Object) <strong>restore_environment</strong>(env, data) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <!-- Provides the  slot annotation -->
<li class="public ">
  <span class="summary_signature">
    
      <a href="#restore_tab-instance_method" title="#restore_tab (instance method)">- (Pane) <strong>restore_tab</strong>(env, tab, cursor_positions, unnamed_docs) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Restores a pane.</p></div></span>
  
</li>

      
        <!-- Provides the  slot annotation -->
<li class="private ">
  <span class="summary_signature">
    
      <a href="#tab_to_tree-instance_method" title="#tab_to_tree (instance method)">- (Array&lt;Array,Integer,String&gt;) <strong>tab_to_tree</strong>(pane, docs) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  

  
    <span class="summary_desc"><div class='inline'><p>A representation of a pane&#8217;s configuration suitable to be written to a configuration
object.</p></div></span>
  
</li>

      
        <!-- Provides the  slot annotation -->
<li class="public ">
  <span class="summary_signature">
    
      <a href="#tabs_state-instance_method" title="#tabs_state (instance method)">- (Hash) <strong>tabs_state</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The open tabs configuration in a form suitable to be written to a configuration object.</p></div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="restore_environment-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>restore_environment</strong>(env, data) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


104
105
106
107
108
109
110
111
112
113
114
115
116</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'plugins/state/state.rb', line 104</span>

<span class='kw'>def</span> <span class='id restore_environment'>restore_environment</span> <span class='id env'>env</span><span class='comma'>,</span> <span class='id data'>data</span>
  <span class='id unnamed_docs'>unnamed_docs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id env'>env</span><span class='period'>.</span><span class='id close_editors'>close_editors</span> <span class='id env'>env</span><span class='period'>.</span><span class='id views'>views</span><span class='comma'>,</span> <span class='kw'>false</span>
  <span class='id data'>data</span><span class='lbracket'>[</span><span class='symbol'>:tabs</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id t'>t</span><span class='comma'>,</span> <span class='id i'>i</span><span class='op'>|</span>
    <span class='id restore_tab'>restore_tab</span> <span class='id env'>env</span><span class='comma'>,</span> <span class='id t'>t</span><span class='comma'>,</span> <span class='id data'>data</span><span class='lbracket'>[</span><span class='symbol'>:cursor_positions</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id unnamed_docs'>unnamed_docs</span>
  <span class='kw'>end</span>
  <span class='id active_editor'>active_editor</span> <span class='op'>=</span> <span class='id data'>data</span><span class='lbracket'>[</span><span class='symbol'>:active_view</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id active_editor'>active_editor</span>
    <span class='id editor'>editor</span> <span class='op'>=</span> <span class='id env'>env</span><span class='period'>.</span><span class='id tabs'>tabs</span><span class='lbracket'>[</span><span class='id active_editor'>active_editor</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id to_a'>to_a</span><span class='lbracket'>[</span><span class='id active_editor'>active_editor</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
    <span class='id env'>env</span><span class='period'>.</span><span class='id activate_editor'>activate_editor</span> <span class='id editor'>editor</span>
    <span class='id editor'>editor</span><span class='period'>.</span><span class='id set_focus'>set_focus</span> <span class='kw'>if</span> <span class='id editor'>editor</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="restore_tab-instance_method">
  
    - (<tt><span class='object_link'><a href="../Pane.html" title="Ruber::Pane (class)">Pane</a></span></tt>) <strong>restore_tab</strong>(env, tab, cursor_positions, unnamed_docs) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Restores a pane</p>
<p>Restoring a pane means creating the editors which were contained in the pane,
in the correct disposition.</p>
<p>The contents of the pane are described by the array <em>data</em>, which has the following
format:</p>
<ul>
	<li>if it has a single element, the corresponding pane contains only a view. If the
  element is a string, it must represent the <span class="caps">URL</span> of the document the view is associated
  with. If it is a number, it means the view is associated with a document which
  hasn&#8217;t been saved</li>
	<li>if it has more than one element, it means that the pane contains more than one
  view. The first element represents the orientation of the pane and can be either
  <code>Qt::Horizontal</code> or <code>Qt::Vertical</code>. The other elements can be either strings,
  numbers or arrays. A string or number means, as above, the <span class="caps">URL</span> of the document
  associated with the view or a document which isn&#8217;t associated with a file. An
  array (which should have the same format as this) means a sub pane</li>
</ul>

  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the array containing the description of the contents of the
pane</p></div>
      
    </li>
  
    <li>
      
        <span class='name'>docs</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../Document.html" title="Ruber::Document (class)">Document</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the document not associated with files to use for
the numeric entries of <em>data</em>. A number <em>n</em> in <em>data</em> means to use the entry
<em>n</em> in <em>docs</em></p></div>
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Pane.html" title="Ruber::Pane (class)">Pane</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the new pane</p></div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'plugins/state/state.rb', line 144</span>

<span class='kw'>def</span> <span class='id restore_tab'>restore_tab</span> <span class='id env'>env</span><span class='comma'>,</span> <span class='id tab'>tab</span><span class='comma'>,</span> <span class='id cursor_positions'>cursor_positions</span><span class='comma'>,</span> <span class='id unnamed_docs'>unnamed_docs</span>
  <span class='id world'>world</span> <span class='op'>=</span> <span class='const'>Ruber</span><span class='lbracket'>[</span><span class='symbol'>:world</span><span class='rbracket'>]</span>
  <span class='id find_first_view'>find_first_view</span> <span class='op'>=</span> <span class='id lambda'>lambda</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id array'>array</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id array'>array</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>==</span> <span class='int'>1</span> <span class='kw'>then</span> <span class='id array'>array</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='kw'>elsif</span> <span class='id array'>array</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id is_a?'>is_a?</span> <span class='const'>Array</span> <span class='kw'>then</span> <span class='id find_first_view'>find_first_view</span><span class='period'>.</span><span class='id call'>call</span> <span class='id array'>array</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>else</span> <span class='id array'>array</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id recreate_pane'>recreate_pane</span> <span class='op'>=</span> <span class='id lambda'>lambda</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id pn'>pn</span><span class='comma'>,</span> <span class='id array'>array</span><span class='op'>|</span>
    <span class='id orientation'>orientation</span> <span class='op'>=</span> <span class='id array'>array</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id last_view'>last_view</span> <span class='op'>=</span> <span class='id pn'>pn</span><span class='period'>.</span><span class='id view'>view</span>
    <span class='id array'>array</span><span class='period'>.</span><span class='id each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id e'>e</span><span class='comma'>,</span> <span class='id i'>i</span><span class='op'>|</span>
      <span class='comment'>#the first element of the array is the orientation; the second is
</span>      <span class='comment'>#the first view, which is already contained in the pane
</span>      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id i'>i</span> <span class='op'>&lt;</span> <span class='int'>2</span> 
      <span class='id view'>view</span> <span class='op'>=</span> <span class='id e'>e</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id find_first_view'>find_first_view</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span><span class='id e'>e</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id e'>e</span>
      <span class='kw'>if</span> <span class='id view'>view</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span> 
        <span class='id doc'>doc</span> <span class='op'>=</span> <span class='id world'>world</span><span class='period'>.</span><span class='id document'>document</span><span class='lparen'>(</span><span class='const'>KDE</span><span class='op'>::</span><span class='const'>Url</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id view'>view</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id world'>world</span><span class='period'>.</span><span class='id new_document'>new_document</span>
      <span class='kw'>else</span> <span class='id doc'>doc</span> <span class='op'>=</span> <span class='id unnamed_docs'>unnamed_docs</span><span class='lbracket'>[</span><span class='id view'>view</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id world'>world</span><span class='period'>.</span><span class='id new_document'>new_document</span>
      <span class='kw'>end</span>
      <span class='id view'>view</span> <span class='op'>=</span> <span class='id doc'>doc</span><span class='period'>.</span><span class='id create_view'>create_view</span>
      <span class='id pn'>pn</span><span class='period'>.</span><span class='id split'>split</span> <span class='id last_view'>last_view</span><span class='comma'>,</span> <span class='id view'>view</span><span class='comma'>,</span> <span class='id orientation'>orientation</span>
      <span class='id last_view'>last_view</span> <span class='op'>=</span> <span class='id view'>view</span>
      <span class='id recreate_pane'>recreate_pane</span><span class='period'>.</span><span class='id call'>call</span> <span class='id view'>view</span><span class='period'>.</span><span class='id parent'>parent</span><span class='comma'>,</span> <span class='id e'>e</span> <span class='kw'>if</span> <span class='id e'>e</span><span class='period'>.</span><span class='id is_a?'>is_a?</span> <span class='const'>Array</span>
    <span class='kw'>end</span>
    <span class='id recreate_pane'>recreate_pane</span><span class='period'>.</span><span class='id call'>call</span> <span class='id pn'>pn</span><span class='period'>.</span><span class='id splitter'>splitter</span><span class='period'>.</span><span class='id widget'>widget</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id array'>array</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id array'>array</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id view'>view</span> <span class='op'>=</span> <span class='id find_first_view'>find_first_view</span><span class='period'>.</span><span class='id call'>call</span> <span class='id tab'>tab</span>
  <span class='kw'>if</span> <span class='id view'>view</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span> 
    <span class='id doc'>doc</span> <span class='op'>=</span> <span class='id world'>world</span><span class='period'>.</span><span class='id document'>document</span><span class='lparen'>(</span><span class='const'>KDE</span><span class='op'>::</span><span class='const'>Url</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id view'>view</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>else</span> <span class='id doc'>doc</span> <span class='op'>=</span> <span class='id unnamed_docs'>unnamed_docs</span><span class='lbracket'>[</span><span class='id view'>view</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'>Ruber</span><span class='lbracket'>[</span><span class='symbol'>:world</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id new_document'>new_document</span>
  <span class='kw'>end</span>
  <span class='id view'>view</span> <span class='op'>=</span> <span class='id env'>env</span><span class='period'>.</span><span class='id editor_for!'>editor_for!</span> <span class='id doc'>doc</span><span class='comma'>,</span> <span class='symbol'>:existing</span> <span class='op'>=&gt;</span> <span class='symbol'>:never</span><span class='comma'>,</span> <span class='symbol'>:new</span> <span class='op'>=&gt;</span> <span class='symbol'>:new_tab</span>
  <span class='id pane'>pane</span> <span class='op'>=</span> <span class='id view'>view</span><span class='period'>.</span><span class='id parent'>parent</span>
  <span class='id recreate_pane'>recreate_pane</span><span class='period'>.</span><span class='id call'>call</span> <span class='id pane'>pane</span><span class='comma'>,</span> <span class='id tab'>tab</span>
  <span class='id pane'>pane</span><span class='period'>.</span><span class='id views'>views</span><span class='period'>.</span><span class='id each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id v'>v</span><span class='comma'>,</span> <span class='id i'>i</span><span class='op'>|</span>
    <span class='id pos'>pos</span> <span class='op'>=</span> <span class='id cursor_positions'>cursor_positions</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span>
    <span class='id v'>v</span><span class='period'>.</span><span class='id go_to'>go_to</span> <span class='op'>*</span><span class='id pos'>pos</span> <span class='kw'>if</span> <span class='id pos'>pos</span>
  <span class='kw'>end</span>
  <span class='id pane'>pane</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="tab_to_tree-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>,Integer,<span class='object_link'><a href="../../String.html" title="String (class)">String</a></span>&gt;</tt>) <strong>tab_to_tree</strong>(pane, docs)  <span class="extras">(private)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>A representation of a pane&#8217;s configuration suitable to be written to a configuration
object</p>

  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>pane</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Pane.html" title="Ruber::Pane (class)">Pane</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the pane to return the representation for</p></div>
      
    </li>
  
    <li>
      
        <span class='name'>docs</span>
      
      
        <span class='type'>(<tt>Hash{<span class='object_link'><a href="../Document.html" title="Ruber::Document (class)">Document</a></span>=&gt;Integer}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a map between documents not associated
with files and the number to represent them</p></div>
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>,Integer,<span class='object_link'><a href="../../String.html" title="String (class)">String</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>an array as described in #restore_pane</p></div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'plugins/state/state.rb', line 197</span>

<span class='kw'>def</span> <span class='id tab_to_tree'>tab_to_tree</span> <span class='id pane'>pane</span><span class='comma'>,</span> <span class='id docs'>docs</span>
  <span class='kw'>if</span> <span class='id pane'>pane</span><span class='period'>.</span><span class='id single_view?'>single_view?</span>
    <span class='id doc'>doc</span> <span class='op'>=</span> <span class='id pane'>pane</span><span class='period'>.</span><span class='id view'>view</span><span class='period'>.</span><span class='id document'>document</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id doc'>doc</span><span class='period'>.</span><span class='id has_file?'>has_file?</span> <span class='op'>?</span> <span class='id doc'>doc</span><span class='period'>.</span><span class='id url'>url</span><span class='period'>.</span><span class='id url'>url</span> <span class='op'>:</span> <span class='id docs'>docs</span><span class='lbracket'>[</span><span class='id doc'>doc</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id panes'>panes</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id tab_to_tree_prc'>tab_to_tree_prc</span> <span class='op'>=</span> <span class='id lambda'>lambda</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id pn'>pn</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id pn'>pn</span><span class='period'>.</span><span class='id single_view?'>single_view?</span>
      <span class='id doc'>doc</span> <span class='op'>=</span> <span class='id pn'>pn</span><span class='period'>.</span><span class='id view'>view</span><span class='period'>.</span><span class='id document'>document</span>
      <span class='id panes'>panes</span><span class='lbracket'>[</span><span class='id pn'>pn</span><span class='period'>.</span><span class='id parent_pane'>parent_pane</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='id doc'>doc</span><span class='period'>.</span><span class='id has_file?'>has_file?</span> <span class='op'>?</span> <span class='id doc'>doc</span><span class='period'>.</span><span class='id url'>url</span><span class='period'>.</span><span class='id url'>url</span> <span class='op'>:</span> <span class='id docs'>docs</span><span class='lbracket'>[</span><span class='id doc'>doc</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>else</span> 
      <span class='id data'>data</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id pn'>pn</span><span class='period'>.</span><span class='id orientation'>orientation</span><span class='rbracket'>]</span>
      <span class='id panes'>panes</span><span class='lbracket'>[</span><span class='id pn'>pn</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id data'>data</span>
      <span class='id panes'>panes</span><span class='lbracket'>[</span><span class='id pn'>pn</span><span class='period'>.</span><span class='id parent_pane'>parent_pane</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id data'>data</span> <span class='kw'>if</span> <span class='id pn'>pn</span><span class='period'>.</span><span class='id parent_pane'>parent_pane</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id tab_to_tree_prc'>tab_to_tree_prc</span><span class='period'>.</span><span class='id call'>call</span> <span class='id pane'>pane</span>
  <span class='id pane'>pane</span><span class='period'>.</span><span class='id each_pane'>each_pane</span> <span class='symbol'>:recursive</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id tab_to_tree_prc'>tab_to_tree_prc</span>
  <span class='id panes'>panes</span><span class='lbracket'>[</span><span class='id pane'>pane</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="tabs_state-instance_method">
  
    - (<tt>Hash</tt>) <strong>tabs_state</strong>(env) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>The open tabs configuration in a form suitable to be written to a configuration object</p>

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A hash containing the following keys:</p>
<ul>
	<li><code>:tabs</code>: an array of arrays, with each inner array representing one tab, with
 the format described in #restore_pane. This value is the one to write under
 the <code>state/tabs</code> entry in a project or configuration object</li>
	<li><code>:cursor_positions</code>:an array of arrays. Each inner array corresponds to a tab
 and contains the cursor position of each view. Each cursor position is represented
 as an array with two elements: the first is the line, the second is the column.
 The order the views are is the same used by <span class='object_link'><a href="../Pane.html#each_view-instance_method" title="Ruber::Pane#each_view (method)">Pane#each_view</a></span>. This value is the one to write under
 the <code>state/cursor_positions</code> entry in a project or configuration object</li>
	<li><code>:active_view</code>: the active view. It is represented by a size 2 array, with the
 first element being the index of the tab of the active view and the second being
 the index of the view in the corresponding pane (according to the order used by
 <span class='object_link'><a href="../Pane.html#each_view-instance_method" title="Ruber::Pane#each_view (method)">Pane#each_view</a></span>). If there&#8217;s no active view, this entry is <strong>nil</strong>. This is the value to write under
 the <code>state/active_view</code> entry in a project or configuration object</li>
</ul></div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'plugins/state/state.rb', line 74</span>

<span class='kw'>def</span> <span class='id tabs_state'>tabs_state</span> <span class='id env'>env</span>
  <span class='id res'>res</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id doc_map'>doc_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id doc_idx'>doc_idx</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id env'>env</span><span class='period'>.</span><span class='id documents'>documents</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id doc'>doc</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id doc'>doc</span><span class='period'>.</span><span class='id has_file?'>has_file?</span>
      <span class='id doc_map'>doc_map</span><span class='lbracket'>[</span><span class='id doc'>doc</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id doc_idx'>doc_idx</span>
      <span class='id doc_idx'>doc_idx</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id tabs'>tabs</span> <span class='op'>=</span> <span class='id env'>env</span><span class='period'>.</span><span class='id tabs'>tabs</span>
  <span class='id tabs_tree'>tabs_tree</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id cursor_positions'>cursor_positions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id tabs'>tabs</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id t'>t</span><span class='op'>|</span>
    <span class='id tabs_tree'>tabs_tree</span> <span class='op'>&lt;&lt;</span> <span class='id tab_to_tree'>tab_to_tree</span><span class='lparen'>(</span><span class='id t'>t</span><span class='comma'>,</span> <span class='id doc_map'>doc_map</span><span class='rparen'>)</span>
    <span class='id cursor_positions'>cursor_positions</span> <span class='op'>&lt;&lt;</span> <span class='id t'>t</span><span class='period'>.</span><span class='id map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id v'>v</span><span class='op'>|</span>
      <span class='id pos'>pos</span> <span class='op'>=</span> <span class='id v'>v</span><span class='period'>.</span><span class='id cursor_position'>cursor_position</span>
      <span class='lbracket'>[</span><span class='id pos'>pos</span><span class='period'>.</span><span class='id line'>line</span><span class='comma'>,</span> <span class='id pos'>pos</span><span class='period'>.</span><span class='id column'>column</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id res'>res</span><span class='lbracket'>[</span><span class='symbol'>:tabs</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id tabs_tree'>tabs_tree</span>
  <span class='id res'>res</span><span class='lbracket'>[</span><span class='symbol'>:cursor_positions</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id cursor_positions'>cursor_positions</span>
  <span class='id active'>active</span> <span class='op'>=</span> <span class='id env'>env</span><span class='period'>.</span><span class='id views'>views</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id active'>active</span>
    <span class='id active_tab'>active_tab</span> <span class='op'>=</span> <span class='id env'>env</span><span class='period'>.</span><span class='id tab'>tab</span><span class='lparen'>(</span><span class='id active'>active</span><span class='rparen'>)</span>
    <span class='id res'>res</span><span class='lbracket'>[</span><span class='symbol'>:active_view</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id tabs'>tabs</span><span class='period'>.</span><span class='id index'>index</span><span class='lparen'>(</span><span class='id active_tab'>active_tab</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id active_tab'>active_tab</span><span class='period'>.</span><span class='id to_a'>to_a</span><span class='period'>.</span><span class='id index'>index</span><span class='lparen'>(</span><span class='id active'>active</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id res'>res</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sun Oct 23 14:12:13 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.3 (ruby-1.9.3).
</div>

  </body>
</html>